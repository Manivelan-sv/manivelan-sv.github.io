<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publication Files</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/line-numbers/prism-line-numbers.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> <!-- Font Awesome CSS -->
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,300;0,400;0,600;0,700;1,300;1,400&display=swap");

* {
  margin: 1%;
  padding: 0;
  box-sizing: border-box;
  text-decoration: none;
  outline: none;
  border: none;
  text-transform: capitalize;
  transition: all 0.2s linear;
}
html {
  font-size: 70%;
  color: #ff7b00;
  overflow-x: hidden;
  scroll-behavior: smooth;
}
body {
  background: #000000;
  font-family: "Poppins", sans-serif;
}

*::selection {
  background: #000000;
  color: #ffffff;
}

html {
  font-size: 100%;
  overflow-x: hidden;
}
html::-webkit-scrollbar {
  width: 0.8rem;
}
html::-webkit-scrollbar-track {
  background: rgb(156, 142, 160);
}
html::-webkit-scrollbar-thumb {
  background: #ffffff;
}

        /* Style for modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 85%;
            max-width: 800px;
            overflow: auto;
        }

        .close {
            color: #ff0000;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        /* Code block styling */
        pre {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 20px;
            line-height: 1.5;
            overflow-x: auto;
            position: relative;
        }

        pre code {
            display: inline;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            font-size: 16px;
            line-height: 1.5;
        }

        .folder-icon {
            margin-right: 10px;
             /* Adjust margin as needed */
        }
        /* Set font color for file and folder names */
        #files a {
            color: #fff; /* Change font color to white */
            text-decoration: none; /* Remove underline from links */
        }

        #files a:hover {
            text-decoration: underline; /* Add underline on hover */
        }

        footer {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            color: #ffffff8f;
            text-align: center;
            padding: 10px 0;
            margin-top: 30px; /* Add margin to separate from content */
            text-align: center; /* Center align the text */
            font-size: 8px; /* Set font size */
            color: #666; /* Set font color */
        }

        /* Disclaimer text styles */
        footer p {
            margin: 0; /* Remove default margin */
        }
        
    </style>
</head>
<body>
    <br>
    <h1 id="folder-heading">Published article's programming code</h1>
    <br>
    <ul id="files"></ul>

    <!-- Modal for displaying content -->
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="file-content"></div>
            <a id="download-link" class="download-link" href="#" download>Download File</a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js"></script>
    <script>
        // GitHub repository details
        const owner = "Manivelan-sv";
        const repo = "Published-Article-s-Programming-Code";
        let currentPath = "Code";

        // GitHub API endpoint to fetch contents of a directory
        const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${currentPath}`;

        // Fetch files and directories from GitHub API
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                // Render files and directories
                renderFilesAndDirectories(data);
            })
            .catch(error => {
                console.error('Error fetching files:', error);
            });

         // Function to fetch contents of a directory
         function fetchDirectoryContents(url) {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    currentPath = data[0].path.split('/').slice(1, -1).join('/');
                    document.getElementById('folder-heading').innerText = currentPath;
                    renderFilesAndDirectories(data);
                })
                .catch(error => {
                    console.error('Error fetching directory contents:', error);
                });
        }


        // Function to render files and directories
        function renderFilesAndDirectories(data) {
            const filesList = document.getElementById('files');
            filesList.innerHTML = "";

            if (currentPath !== "Code") {
                const backLink = document.createElement('li');
                const backLinkA = document.createElement('a');
                backLinkA.textContent = "Previous Directory";
                backLinkA.href = "#";
                backLinkA.onclick = () => {
                    const lastSlashIndex = currentPath.lastIndexOf('/');
                    const parentPath = lastSlashIndex > 0 ? currentPath.substring(0, lastSlashIndex) : '';
                    fetchDirectoryContents(`https://api.github.com/repos/${owner}/${repo}/contents/${parentPath}`);
                };
                backLink.appendChild(backLinkA);
                filesList.appendChild(backLink);
            }

            data.forEach(item => {
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.textContent = item.name;
                link.href = "#";
                link.onclick = () => {
                    if (item.type === "file") {
                        displayFileContent(item.path);
                    } else if (item.type === "dir") {
                        fetchDirectoryContents(item.url);
                    }
                };

                if (item.type === "dir") {
                    const folderIcon = document.createElement('i');
                    folderIcon.classList.add('folder-icon', 'fas', 'fa-folder'); // Using Font Awesome folder icon
                    link.prepend(folderIcon);
                }

                listItem.appendChild(link);
                filesList.appendChild(listItem);
            });
        }

        // Function to display file content and initiate download
        function displayFileContent(filePath) {
            const fileUrl = `https://raw.githubusercontent.com/${owner}/${repo}/main/${filePath}`;
            fetch(fileUrl)
                .then(response => response.text())
                .then(content => {
                    // Display content in modal
                    document.getElementById('file-content').innerHTML = `<pre><code class="language-${getFileExtension(filePath)}">${content}</code></pre>`;
                    // Show modal
                    document.getElementById('myModal').style.display = "block";
                    // Manually apply Prism syntax highlighting
                    Prism.highlightAll();
                    // Set download button click listener
                    document.getElementById('download-link').addEventListener('click', () => {
                        downloadFile(content, filePath.split('/').pop());
                    });
                })
                .catch(error => {
                    console.error('Error fetching file content:', error);
                });
        }

        // Function to download file using Blob object
        function downloadFile(content, fileName) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }

        // Close modal when clicking on close button
        document.getElementsByClassName('close')[0].onclick = function() {
            document.getElementById('myModal').style.display = "none";
        };

        // Close modal when clicking outside the modal
        window.onclick = function(event) {
            if (event.target == document.getElementById('myModal')) {
                document.getElementById('myModal').style.display = "none";
            }
        };

        // Function to get file extension
        function getFileExtension(fileName) {
            return fileName.split('.').pop();
        }
    </script>
    <footer>
        <center><div class="resumebtn">
            <a href=",/" target="_blank" class="btn" style="color: #eb0000; font-size: 16px;"><span>More About Myself</span><i class="fas fa-user-alt"></i></a>
          </div></center>
          <br><br>
        <h>*Disclaimer:*</h>
        <p>The programming code provided on this website is intended solely for educational and research purposes. It is a result of original work by ME and has been developed with contributions from various sources, including online resources, guidance from my supervisor, collaborators, and previous work from other researchers. While efforts have been made to ensure the accuracy and reliability of the code, no guarantee is provided regarding its correctness for any particular purpose. Users are encouraged to review and modify the code according to their own requirements and to exercise caution when implementing it in their own projects.</p>
    </footer>
</body>
</html>
